{"version":3,"file":"index.mjs","sources":["../../src/vite/path.ts","../../src/vite/markdownSection.ts","../../src/vite/pageProperties/dynamic/readingTime.ts","../../src/vite/pageProperties/index.ts"],"sourcesContent":["import { normalizePath } from 'vite'\n\nexport function pathEquals(path: string, equals: string): boolean {\n  return normalizePath(path) === (normalizePath(equals))\n}\n\nexport function pathStartsWith(path: string, startsWith: string): boolean {\n  return normalizePath(path).startsWith(normalizePath(startsWith))\n}\n\nexport function pathEndsWith(path: string, startsWith: string): boolean {\n  return normalizePath(path).endsWith(normalizePath(startsWith))\n}\n","import { env } from 'node:process'\nimport { relative } from 'node:path'\nimport type { Plugin } from 'vite'\nimport GrayMatter from 'gray-matter'\nimport {\n  pathEndsWith,\n  pathEquals,\n  pathStartsWith,\n} from './path'\n\nexport interface Context {\n  helpers: {\n    /**\n     * A helper function to help to determine whether the passed string parameter equals the\n     * current transforming module ID with normalization of paths capabilities and\n     * cross platform / OS compatibilities.\n     *\n     * @param equalsWith - String to equal with\n     * @returns boolean\n     */\n    idEquals: (equalsWith: string) => boolean\n    /**\n     * A helper function to help to determine whether the passed string parameter startsWith the\n     * current transforming module ID with normalization of paths capabilities and\n     * cross platform / OS compatibilities.\n     *\n     * @param startsWith - String to start with\n     * @returns boolean\n     */\n    idStartsWith: (startsWith: string) => boolean\n    /**\n     * A helper function to help to determine whether the passed string parameter endsWith the\n     * current transforming module ID with normalization of paths capabilities and\n     * cross platform / OS compatibilities.\n     *\n     * @param endsWith - String to end with\n     * @returns boolean\n     */\n    idEndsWith: (endsWith: string) => boolean\n    /**\n     * A helper function to help to determine whether the passed first path parameter\n     * equals the second passed string with normalization of paths capabilities and\n     * cross platform / OS compatibilities.\n     *\n     * @param path - Path to be compared with\n     * @param equalsWith - String to equal with\n     * @returns boolean\n     */\n    pathEquals: (path: string, equalsWith: string) => boolean\n    /**\n     * A helper function to help to determine whether the passed first path parameter\n     * startsWith the second passed string with normalization of paths capabilities and\n     * cross platform / OS compatibilities.\n     *\n     * @param path - Path to be compared with\n     * @param startsWith - String to start with\n     * @returns boolean\n     */\n    pathStartsWith: (path: string, startsWith: string) => boolean\n    /**\n     * A helper function to help to determine whether the passed first path parameter\n     * endsWith the second passed string with normalization of paths capabilities and\n     * cross platform / OS compatibilities.\n     *\n     * @param path - Path to be compared with\n     * @param endsWith - String to end with\n     * @returns boolean\n     */\n    pathEndsWith: (path: string, endsWith: string) => boolean\n  }\n}\n\nexport interface PagePropertiesMarkdownSectionOptions {\n  /**\n   * The list of file names to exclude from the transformation\n   *\n   * @default ['index.md']\n   */\n  excludes?: string[]\n  /**\n   * The function to exclude the file from the transformation\n   *\n   * @param id - the current transforming module ID (comes from vite when transform hook is called)\n   * @param context - the context object, contains several helper functions\n   * @returns boolean\n   * @default () => false\n   */\n  exclude?: (id: string, context: Context) => boolean\n}\n\nexport function PagePropertiesMarkdownSection(options?: PagePropertiesMarkdownSectionOptions): Plugin {\n  const {\n    excludes = ['index.md'],\n    exclude = () => false,\n  } = options ?? {}\n\n  let root = ''\n\n  return {\n    name: '@nolebase/vitepress-plugin-page-properties-markdown-section',\n    // May set to 'pre' since end user may use vitepress wrapped vite plugin to\n    // specify the plugins, which may cause this plugin to be executed after\n    // vitepress or the other markdown processing plugins.\n    enforce: 'pre',\n    configResolved(config) {\n      root = config.root ?? ''\n    },\n    transform(code, id) {\n      function idEndsWith(endsWith: string) {\n        return pathEndsWith(relative(root, id), endsWith)\n      }\n\n      function idEquals(equals: string) {\n        return pathEquals(relative(root, id), equals)\n      }\n\n      function idStartsWith(startsWith: string) {\n        return pathStartsWith(relative(root, id), startsWith)\n      }\n\n      const context: Context = {\n        helpers: {\n          pathEndsWith,\n          pathEquals,\n          pathStartsWith,\n          idEndsWith,\n          idEquals,\n          idStartsWith,\n        },\n      }\n\n      if (!id.endsWith('.md'))\n        return null\n      if (excludes.includes(relative(root, id)))\n        return null\n      if (exclude(id, context))\n        return null\n\n      const targetComponent = env.NODE_ENV === 'development'\n        ? TemplatePagePropertiesEditor()\n        : TemplatePageProperties()\n\n      const parsedMarkdownContent = GrayMatter(code)\n\n      if ('nolebase' in parsedMarkdownContent.data && 'pageProperties' in parsedMarkdownContent.data.nolebase && !parsedMarkdownContent.data.nolebase.pageProperties)\n        return null\n      if ('pageProperties' in parsedMarkdownContent.data && !parsedMarkdownContent.data.pageProperties)\n        return null\n\n      const hasFrontmatter = Object.keys(parsedMarkdownContent.data).length > 0\n\n      // match any heading and move heading to top, then insert component after heading\n      const headingMatch = parsedMarkdownContent.content.match(/^#{1} .*/m)\n      if (!headingMatch || !headingMatch[0] || headingMatch.index === undefined) {\n        if (!hasFrontmatter)\n          return `${targetComponent}\\n\\n${code}`\n\n        return `${GrayMatter.stringify(`${targetComponent}\\n\\n${parsedMarkdownContent.content}`, parsedMarkdownContent.data)}`\n      }\n\n      const headingPart = parsedMarkdownContent.content.slice(0, headingMatch.index + headingMatch[0].length)\n      const contentPart = parsedMarkdownContent.content.slice(headingMatch.index + headingMatch[0].length)\n\n      if (!hasFrontmatter)\n        return `${headingPart}\\n${targetComponent}\\n\\n${contentPart}`\n\n      return `${GrayMatter.stringify(`${headingPart}\\n${targetComponent}\\n\\n${contentPart}`, parsedMarkdownContent.data)}`\n    },\n  }\n}\n\nfunction TemplatePagePropertiesEditor(): string {\n  return `\n\n<NolebasePagePropertiesEditor />\n`\n}\n\nfunction TemplatePageProperties(): string {\n  return `\n\n<NolebasePageProperties />\n\n`\n}\n","// Great thanks to the following authors for the excellent reading time calculation code implementation\n//\n// Repository: vuepress-theme-hope\n// By: Mister-Hope <https://github.com/Mister-Hope>\n// Source code at: vuepress-theme-hope/packages/reading-time2/src/node/readingTime.ts <https://github.com/vuepress-theme-hope/vuepress-theme-hope/blob/main/packages/reading-time2/src/node/readingTime.ts>\n//\n// Repository: vuepress-theme-gungnir\n// By: Renovamen <https://github.com/Renovamen>\n// Source code at: vuepress-theme-gungnir/packages/plugins/reading-time/reading-time.js <https://github.com/Renovamen/vuepress-theme-gungnir/blob/v0/packages/plugins/reading-time/reading-time.js>\n//\n// Heavily inspired by the above two repositories, the following code is a combination of the two with some modifications and improvements.\n\n// Types for different language handlers and reading time calculation\nexport interface LanguageHandler {\n  regex: RegExp\n  wordsPerMinute: number\n}\n\nexport interface ReadingTimeStats {\n  readingTime: number\n  wordsCount: number\n}\n\n// Default language handlers for Chinese and Latin/Cyrillic based languages\nconst languageHandlers: Record<string, LanguageHandler> = {\n  japanese: {\n    regex: /\\p{Script=Hiragana}|\\p{Script=Katakana}/gu, // Match Japanese characters\n    wordsPerMinute: 400, // Hypothetical average reading speed for Japanese\n  },\n  chinese: {\n    regex: /\\p{Script=Han}/gu, // Match Chinese characters\n    wordsPerMinute: 300, // Average reading speed for Chinese\n  },\n  latinCyrillic: {\n    regex: /[\\p{Script=Latin}\\p{Script=Cyrillic}\\p{Mark}\\p{Punctuation}\\p{Number}'\\b]+/gu, // Match Latin and Cyrillic characters\n    wordsPerMinute: 160, // Average reading speed for English and similar languages\n  },\n}\n\n// Function to count words in a text based on the provided language handlers\nfunction countWordsByLanguage(content: string): Record<string, number> {\n  return Object.keys(languageHandlers).reduce((accumulator, language) => {\n    const match = content.match(languageHandlers[language].regex)\n    accumulator[language] = match ? match.length : 0\n\n    return accumulator\n  }, {})\n}\n\n// Function to calculate reading time across multiple languages\nexport function calculateWordsCountAndReadingTime(content: string): ReadingTimeStats {\n  const wordsCounts = countWordsByLanguage(content)\n\n  const totalWords = Object.values(wordsCounts).reduce((sum, count) => sum + count, 0)\n  const totalMinutes = Object.entries(wordsCounts).reduce((sum, [language, count]) => {\n    return sum + (count / languageHandlers[language].wordsPerMinute)\n  }, 0)\n\n  return {\n    readingTime: Math.ceil(totalMinutes),\n    wordsCount: totalWords,\n  }\n}\n","import {\n  existsSync,\n  lstatSync,\n  readFileSync,\n} from 'node:fs'\nimport { extname, join, relative } from 'node:path'\nimport type { Plugin, ResolvedConfig } from 'vite'\nimport { normalizePath } from 'vite'\nimport GrayMatter from 'gray-matter'\nimport type { PagePropertiesData } from './types'\nimport type { LanguageHandler, ReadingTimeStats } from './dynamic/readingTime'\nimport { calculateWordsCountAndReadingTime } from './dynamic/readingTime'\n\nconst VirtualModuleID = 'virtual:nolebase-page-properties'\nconst ResolvedVirtualModuleId = `\\0${VirtualModuleID}`\n\nexport type {\n  LanguageHandler,\n  ReadingTimeStats as ReadingTimeResult,\n}\n\nfunction normalizeWithRelative(from: string, path: string) {\n  return normalizePath(relative(from, path)).toLowerCase()\n}\n\nfunction normalizeAsMarkdownPath(url: string) {\n  // parse url to get the pathname without query strings\n  let toMarkdownFilePath = url.split('?')[0]\n  // if the pathname starts with '/', remove it\n  if (toMarkdownFilePath.startsWith('/'))\n    toMarkdownFilePath = toMarkdownFilePath.slice(1)\n  // if the pathname ends with '/', append 'index.md'\n  if (toMarkdownFilePath.endsWith('/')) {\n    toMarkdownFilePath += 'index.md'\n  }\n  else {\n    if (extname(toMarkdownFilePath) === '.html') {\n      toMarkdownFilePath = toMarkdownFilePath\n        .replace(/^(.+?)(\\.html)?$/s, '$1.md')\n    }\n  }\n\n  return toMarkdownFilePath\n}\n\nexport function PageProperties(): Plugin {\n  let _config: ResolvedConfig\n  const data: PagePropertiesData = {}\n  const knownMarkdownFiles = new Set<string>()\n\n  return {\n    name: '@nolebase/vitepress-plugin-page-properties',\n    // May set to 'pre' since end user may use vitepress wrapped vite plugin to\n    // specify the plugins, which may cause this plugin to be executed after\n    // vitepress or the other markdown processing plugins.\n    enforce: 'pre',\n    config: () => ({\n      optimizeDeps: {\n        exclude: [\n          '@nolebase/vitepress-plugin-page-properties/client',\n        ],\n      },\n      ssr: {\n        noExternal: [\n          '@nolebase/vitepress-plugin-page-properties',\n        ],\n      },\n    }),\n    configResolved(config) {\n      _config = config\n    },\n    resolveId(id) {\n      if (id === VirtualModuleID)\n        return ResolvedVirtualModuleId\n    },\n    load(id) {\n      if (id !== ResolvedVirtualModuleId)\n        return null\n\n      return `export default ${JSON.stringify(data)}`\n    },\n    transform(code, id) {\n      if (!id.endsWith('.md'))\n        return null\n\n      const parsedContent = GrayMatter(code)\n      data[normalizeWithRelative(_config.root, id)] = calculateWordsCountAndReadingTime(parsedContent.content)\n    },\n    configureServer(server) {\n      server.middlewares.use(async (req, _, next) => {\n        if (!req)\n          return next()\n        if (!req.url)\n          return next()\n\n        const toMarkdownFilePath = normalizeAsMarkdownPath(req.url)\n        if (extname(toMarkdownFilePath) !== '.md')\n          return next()\n\n        const completeFilePath = join(_config.root, toMarkdownFilePath)\n\n        if (!knownMarkdownFiles.has(toMarkdownFilePath.toLowerCase())) {\n          try {\n            const exists = await existsSync(completeFilePath)\n            if (!exists)\n              return next()\n\n            const stat = await lstatSync(completeFilePath)\n            if (!stat.isFile())\n              return next()\n\n            knownMarkdownFiles.add(toMarkdownFilePath.toLowerCase())\n          }\n          catch (e) {\n            return next()\n          }\n        }\n        if (!knownMarkdownFiles.has(toMarkdownFilePath.toLowerCase()))\n          return next()\n\n        const content = await readFileSync(completeFilePath, 'utf-8')\n        const parsedContent = GrayMatter(content)\n        const key = normalizeWithRelative(_config.root, completeFilePath)\n        data[key] = calculateWordsCountAndReadingTime(parsedContent.content)\n\n        const virtualModule = server.moduleGraph.getModuleById(ResolvedVirtualModuleId)\n        if (!virtualModule)\n          return next()\n\n        server.moduleGraph.invalidateModule(virtualModule)\n        server.hot.send({\n          type: 'custom',\n          event: 'nolebase-page-properties:updated',\n          data,\n        })\n\n        next()\n      })\n    },\n    async handleHotUpdate(ctx) {\n      const hotReloadingModuleFilePath = normalizeWithRelative(_config.root, ctx.file)\n\n      if (extname(hotReloadingModuleFilePath) === '.md') {\n        const virtualModule = ctx.server.moduleGraph.getModuleById(ResolvedVirtualModuleId)\n\n        if (virtualModule) {\n          const content = await ctx.read()\n          const parsedContent = GrayMatter(content)\n          data[hotReloadingModuleFilePath] = calculateWordsCountAndReadingTime(parsedContent.content)\n          ctx.server.moduleGraph.invalidateModule(virtualModule)\n\n          return [virtualModule]\n        }\n      }\n    },\n  }\n}\n"],"names":[],"mappings":"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"}